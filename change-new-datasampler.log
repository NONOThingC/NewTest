hyper-parameter configurations:
{'gpu': 0, 'dataname': 'TACRED', 'task_name': 'TACRED', 'max_length': 256, 'this_name': 'continual', 'device': device(type='cuda'), 'batch_size': 40, 'learning_rate': 5e-06, 'total_round': 5, 'rel_per_task': 4, 'pattern': 'entity_marker', 'encoder_output_size': 768, 'vocab_size': 30522, 'marker_size': 4, 'temp': 0.1, 'feat_dim': 64, 'kl_temp': 10, 'num_workers': 0, 'step1_epochs': 1, 'step2_epochs': 1, 'seed': 2021, 'max_grad_norm': 10, 'num_protos': 20, 'optim': 'adam', 'data_path': 'datasets/', 'bert_path': '/home/v-chengweihu/code/bert-base-uncased', 'n_gpu': 1}
Special tokens have been added in the vocabulary, make sure the associated word embedding are fine-tuned or trained.
['per:cities_of_residence', 'per:other_family', 'org:founded', 'per:origin']
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:14,  1.61it/s]  8%|▊         | 2/24 [00:01<00:13,  1.64it/s] 12%|█▎        | 3/24 [00:01<00:12,  1.67it/s] 17%|█▋        | 4/24 [00:02<00:11,  1.67it/s] 21%|██        | 5/24 [00:02<00:11,  1.68it/s] 25%|██▌       | 6/24 [00:03<00:10,  1.68it/s] 29%|██▉       | 7/24 [00:04<00:10,  1.68it/s] 33%|███▎      | 8/24 [00:04<00:09,  1.68it/s] 38%|███▊      | 9/24 [00:05<00:08,  1.67it/s] 42%|████▏     | 10/24 [00:05<00:08,  1.68it/s] 46%|████▌     | 11/24 [00:06<00:07,  1.69it/s] 50%|█████     | 12/24 [00:07<00:07,  1.69it/s] 54%|█████▍    | 13/24 [00:07<00:06,  1.69it/s] 58%|█████▊    | 14/24 [00:08<00:05,  1.69it/s] 62%|██████▎   | 15/24 [00:08<00:05,  1.69it/s] 67%|██████▋   | 16/24 [00:09<00:04,  1.69it/s] 71%|███████   | 17/24 [00:10<00:04,  1.70it/s] 75%|███████▌  | 18/24 [00:10<00:03,  1.70it/s] 79%|███████▉  | 19/24 [00:11<00:02,  1.69it/s] 83%|████████▎ | 20/24 [00:11<00:02,  1.69it/s] 88%|████████▊ | 21/24 [00:12<00:01,  1.69it/s] 92%|█████████▏| 22/24 [00:13<00:01,  1.69it/s] 96%|█████████▌| 23/24 [00:13<00:00,  1.69it/s]100%|██████████| 24/24 [00:13<00:00,  1.99it/s]100%|██████████| 24/24 [00:13<00:00,  1.72it/s]
Use adam optim!
init_train_0:   0%|          | 0/24 [00:00<?, ?it/s]init_train_0:   0%|          | 0/24 [00:00<?, ?it/s, loss=6.36]init_train_0:   4%|▍         | 1/24 [00:01<00:39,  1.72s/it, loss=6.36]init_train_0:   4%|▍         | 1/24 [00:02<00:39,  1.72s/it, loss=6.32]init_train_0:   8%|▊         | 2/24 [00:03<00:37,  1.72s/it, loss=6.32]init_train_0:   8%|▊         | 2/24 [00:04<00:37,  1.72s/it, loss=6.3] init_train_0:  12%|█▎        | 3/24 [00:05<00:36,  1.72s/it, loss=6.3]init_train_0:  12%|█▎        | 3/24 [00:05<00:36,  1.72s/it, loss=6.28]init_train_0:  17%|█▋        | 4/24 [00:06<00:34,  1.72s/it, loss=6.28]init_train_0:  17%|█▋        | 4/24 [00:07<00:34,  1.72s/it, loss=6.26]init_train_0:  21%|██        | 5/24 [00:08<00:32,  1.72s/it, loss=6.26]init_train_0:  21%|██        | 5/24 [00:09<00:32,  1.72s/it, loss=6.25]init_train_0:  25%|██▌       | 6/24 [00:10<00:31,  1.72s/it, loss=6.25]init_train_0:  25%|██▌       | 6/24 [00:10<00:31,  1.72s/it, loss=6.25]init_train_0:  29%|██▉       | 7/24 [00:12<00:29,  1.73s/it, loss=6.25]init_train_0:  29%|██▉       | 7/24 [00:12<00:29,  1.73s/it, loss=6.25]init_train_0:  33%|███▎      | 8/24 [00:13<00:27,  1.73s/it, loss=6.25]init_train_0:  33%|███▎      | 8/24 [00:14<00:27,  1.73s/it, loss=6.24]init_train_0:  38%|███▊      | 9/24 [00:15<00:25,  1.73s/it, loss=6.24]init_train_0:  38%|███▊      | 9/24 [00:16<00:25,  1.73s/it, loss=6.24]init_train_0:  42%|████▏     | 10/24 [00:17<00:24,  1.74s/it, loss=6.24]init_train_0:  42%|████▏     | 10/24 [00:17<00:24,  1.74s/it, loss=6.24]init_train_0:  46%|████▌     | 11/24 [00:19<00:22,  1.74s/it, loss=6.24]init_train_0:  46%|████▌     | 11/24 [00:19<00:22,  1.74s/it, loss=6.23]init_train_0:  50%|█████     | 12/24 [00:20<00:20,  1.74s/it, loss=6.23]init_train_0:  50%|█████     | 12/24 [00:21<00:20,  1.74s/it, loss=6.23]init_train_0:  54%|█████▍    | 13/24 [00:22<00:19,  1.75s/it, loss=6.23]init_train_0:  54%|█████▍    | 13/24 [00:23<00:19,  1.75s/it, loss=6.22]init_train_0:  58%|█████▊    | 14/24 [00:24<00:17,  1.75s/it, loss=6.22]init_train_0:  58%|█████▊    | 14/24 [00:24<00:17,  1.75s/it, loss=6.21]init_train_0:  62%|██████▎   | 15/24 [00:26<00:15,  1.75s/it, loss=6.21]init_train_0:  62%|██████▎   | 15/24 [00:26<00:15,  1.75s/it, loss=6.21]init_train_0:  67%|██████▋   | 16/24 [00:27<00:14,  1.75s/it, loss=6.21]init_train_0:  67%|██████▋   | 16/24 [00:28<00:14,  1.75s/it, loss=6.2] init_train_0:  71%|███████   | 17/24 [00:29<00:12,  1.76s/it, loss=6.2]init_train_0:  71%|███████   | 17/24 [00:30<00:12,  1.76s/it, loss=6.19]init_train_0:  75%|███████▌  | 18/24 [00:31<00:10,  1.75s/it, loss=6.19]init_train_0:  75%|███████▌  | 18/24 [00:31<00:10,  1.75s/it, loss=6.19]init_train_0:  79%|███████▉  | 19/24 [00:33<00:08,  1.75s/it, loss=6.19]init_train_0:  79%|███████▉  | 19/24 [00:33<00:08,  1.75s/it, loss=6.18]init_train_0:  83%|████████▎ | 20/24 [00:34<00:07,  1.75s/it, loss=6.18]init_train_0:  83%|████████▎ | 20/24 [00:35<00:07,  1.75s/it, loss=6.17]init_train_0:  88%|████████▊ | 21/24 [00:36<00:05,  1.75s/it, loss=6.17]init_train_0:  88%|████████▊ | 21/24 [00:37<00:05,  1.75s/it, loss=6.17]init_train_0:  92%|█████████▏| 22/24 [00:38<00:03,  1.75s/it, loss=6.17]init_train_0:  92%|█████████▏| 22/24 [00:38<00:03,  1.75s/it, loss=6.16]init_train_0:  96%|█████████▌| 23/24 [00:40<00:01,  1.75s/it, loss=6.16]init_train_0:  96%|█████████▌| 23/24 [00:40<00:01,  1.75s/it, loss=6.16]init_train_0: 100%|██████████| 24/24 [00:40<00:00,  1.49s/it, loss=6.16]init_train_0: 100%|██████████| 24/24 [00:40<00:00,  1.71s/it, loss=6.16]
init_train_0 loss is 6.157953341801961
Restart Num 1
task--1:
current test acc:0.918918918918919
history test acc:0.918918918918919
[0.918918918918919]
[0.918918918918919]
['per:cause_of_death', 'org:dissolved', 'per:employee_of', 'org:member_of']
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:08,  1.67it/s] 13%|█▎        | 2/15 [00:01<00:08,  1.62it/s] 20%|██        | 3/15 [00:01<00:07,  1.61it/s] 27%|██▋       | 4/15 [00:02<00:06,  1.61it/s] 33%|███▎      | 5/15 [00:03<00:06,  1.61it/s] 40%|████      | 6/15 [00:03<00:05,  1.61it/s] 47%|████▋     | 7/15 [00:04<00:04,  1.61it/s] 53%|█████▎    | 8/15 [00:04<00:04,  1.61it/s] 60%|██████    | 9/15 [00:05<00:03,  1.61it/s] 67%|██████▋   | 10/15 [00:06<00:03,  1.60it/s] 73%|███████▎  | 11/15 [00:06<00:02,  1.60it/s] 80%|████████  | 12/15 [00:07<00:01,  1.60it/s] 87%|████████▋ | 13/15 [00:08<00:01,  1.60it/s] 93%|█████████▎| 14/15 [00:08<00:00,  1.60it/s]100%|██████████| 15/15 [00:09<00:00,  1.78it/s]100%|██████████| 15/15 [00:09<00:00,  1.64it/s]
Use adam optim!
init_train_0:   0%|          | 0/15 [00:00<?, ?it/s]init_train_0:   0%|          | 0/15 [00:00<?, ?it/s, loss=6.12]init_train_0:   7%|▋         | 1/15 [00:01<00:25,  1.80s/it, loss=6.12]init_train_0:   7%|▋         | 1/15 [00:02<00:25,  1.80s/it, loss=6.11]init_train_0:  13%|█▎        | 2/15 [00:03<00:23,  1.80s/it, loss=6.11]init_train_0:  13%|█▎        | 2/15 [00:04<00:23,  1.80s/it, loss=6.12]init_train_0:  20%|██        | 3/15 [00:05<00:21,  1.80s/it, loss=6.12]init_train_0:  20%|██        | 3/15 [00:06<00:21,  1.80s/it, loss=6.09]init_train_0:  27%|██▋       | 4/15 [00:07<00:19,  1.80s/it, loss=6.09]init_train_0:  27%|██▋       | 4/15 [00:07<00:19,  1.80s/it, loss=6.08]init_train_0:  33%|███▎      | 5/15 [00:09<00:18,  1.80s/it, loss=6.08]init_train_0:  33%|███▎      | 5/15 [00:09<00:18,  1.80s/it, loss=6.08]init_train_0:  40%|████      | 6/15 [00:10<00:16,  1.80s/it, loss=6.08]init_train_0:  40%|████      | 6/15 [00:11<00:16,  1.80s/it, loss=6.08]init_train_0:  47%|████▋     | 7/15 [00:12<00:14,  1.80s/it, loss=6.08]init_train_0:  47%|████▋     | 7/15 [00:13<00:14,  1.80s/it, loss=6.08]init_train_0:  53%|█████▎    | 8/15 [00:14<00:12,  1.81s/it, loss=6.08]init_train_0:  53%|█████▎    | 8/15 [00:15<00:12,  1.81s/it, loss=6.08]init_train_0:  60%|██████    | 9/15 [00:16<00:10,  1.81s/it, loss=6.08]init_train_0:  60%|██████    | 9/15 [00:16<00:10,  1.81s/it, loss=6.07]init_train_0:  67%|██████▋   | 10/15 [00:18<00:09,  1.81s/it, loss=6.07]init_train_0:  67%|██████▋   | 10/15 [00:18<00:09,  1.81s/it, loss=6.06]init_train_0:  73%|███████▎  | 11/15 [00:19<00:07,  1.81s/it, loss=6.06]init_train_0:  73%|███████▎  | 11/15 [00:20<00:07,  1.81s/it, loss=6.05]init_train_0:  80%|████████  | 12/15 [00:21<00:05,  1.81s/it, loss=6.05]init_train_0:  80%|████████  | 12/15 [00:22<00:05,  1.81s/it, loss=6.04]init_train_0:  87%|████████▋ | 13/15 [00:23<00:03,  1.82s/it, loss=6.04]init_train_0:  87%|████████▋ | 13/15 [00:24<00:03,  1.82s/it, loss=6.02]init_train_0:  93%|█████████▎| 14/15 [00:25<00:01,  1.82s/it, loss=6.02]init_train_0:  93%|█████████▎| 14/15 [00:25<00:01,  1.82s/it, loss=6]   init_train_0: 100%|██████████| 15/15 [00:26<00:00,  1.64s/it, loss=6]init_train_0: 100%|██████████| 15/15 [00:26<00:00,  1.77s/it, loss=6]
init_train_0 loss is 6.002487214406331
WARNING clustering 320 points to 20 centroids: please provide at least 780 training points
WARNING clustering 198 points to 20 centroids: please provide at least 780 training points
WARNING clustering 103 points to 20 centroids: please provide at least 780 training points
WARNING clustering 320 points to 20 centroids: please provide at least 780 training points
WARNING clustering 136 points to 20 centroids: please provide at least 780 training points
WARNING clustering 20 points to 10 centroids: please provide at least 390 training points
WARNING clustering 320 points to 20 centroids: please provide at least 780 training points
WARNING clustering 112 points to 20 centroids: please provide at least 780 training points
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  5.77it/s]100%|██████████| 1/1 [00:00<00:00,  5.76it/s]
Use adam optim!
memory_train_0:   0%|          | 0/1 [00:00<?, ?it/s]memory_train_0: 100%|██████████| 1/1 [00:00<00:00,  1.76it/s]memory_train_0: 100%|██████████| 1/1 [00:00<00:00,  1.76it/s]
memory_train_0 loss is 2.270719051361084
Restart Num 1
task--2:
current test acc:0.9532710280373832
history test acc:0.4196078431372549
[0.918918918918919, 0.9532710280373832]
[0.918918918918919, 0.4196078431372549]
['per:parents', 'per:alternate_names', 'org:top_members/employees', 'per:siblings']
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:11,  1.63it/s] 10%|█         | 2/20 [00:01<00:11,  1.57it/s] 15%|█▌        | 3/20 [00:01<00:10,  1.57it/s] 20%|██        | 4/20 [00:02<00:10,  1.57it/s] 25%|██▌       | 5/20 [00:03<00:09,  1.56it/s] 30%|███       | 6/20 [00:03<00:08,  1.57it/s] 35%|███▌      | 7/20 [00:04<00:08,  1.57it/s] 40%|████      | 8/20 [00:05<00:07,  1.56it/s] 45%|████▌     | 9/20 [00:05<00:07,  1.57it/s] 50%|█████     | 10/20 [00:06<00:06,  1.57it/s] 55%|█████▌    | 11/20 [00:07<00:05,  1.56it/s] 60%|██████    | 12/20 [00:07<00:05,  1.57it/s] 65%|██████▌   | 13/20 [00:08<00:04,  1.56it/s] 70%|███████   | 14/20 [00:08<00:03,  1.56it/s] 75%|███████▌  | 15/20 [00:09<00:03,  1.57it/s] 80%|████████  | 16/20 [00:10<00:02,  1.56it/s] 85%|████████▌ | 17/20 [00:10<00:01,  1.56it/s] 90%|█████████ | 18/20 [00:11<00:01,  1.56it/s] 95%|█████████▌| 19/20 [00:12<00:00,  1.56it/s]100%|██████████| 20/20 [00:12<00:00,  1.73it/s]100%|██████████| 20/20 [00:12<00:00,  1.59it/s]
Use adam optim!
init_train_0:   0%|          | 0/20 [00:00<?, ?it/s]init_train_0:   0%|          | 0/20 [00:00<?, ?it/s, loss=6.02]init_train_0:   5%|▌         | 1/20 [00:01<00:35,  1.85s/it, loss=6.02]init_train_0:   5%|▌         | 1/20 [00:02<00:35,  1.85s/it, loss=5.98]init_train_0:  10%|█         | 2/20 [00:03<00:33,  1.84s/it, loss=5.98]init_train_0:  10%|█         | 2/20 [00:04<00:33,  1.84s/it, loss=5.96]init_train_0:  15%|█▌        | 3/20 [00:05<00:31,  1.84s/it, loss=5.96]init_train_0:  15%|█▌        | 3/20 [00:06<00:31,  1.84s/it, loss=5.94]init_train_0:  20%|██        | 4/20 [00:07<00:29,  1.84s/it, loss=5.94]init_train_0:  20%|██        | 4/20 [00:08<00:29,  1.84s/it, loss=5.95]init_train_0:  25%|██▌       | 5/20 [00:09<00:27,  1.84s/it, loss=5.95]init_train_0:  25%|██▌       | 5/20 [00:09<00:27,  1.84s/it, loss=5.94]init_train_0:  30%|███       | 6/20 [00:11<00:25,  1.84s/it, loss=5.94]init_train_0:  30%|███       | 6/20 [00:11<00:25,  1.84s/it, loss=5.93]init_train_0:  35%|███▌      | 7/20 [00:12<00:23,  1.84s/it, loss=5.93]init_train_0:  35%|███▌      | 7/20 [00:13<00:23,  1.84s/it, loss=5.92]init_train_0:  40%|████      | 8/20 [00:14<00:22,  1.84s/it, loss=5.92]init_train_0:  40%|████      | 8/20 [00:15<00:22,  1.84s/it, loss=5.91]init_train_0:  45%|████▌     | 9/20 [00:16<00:20,  1.84s/it, loss=5.91]init_train_0:  45%|████▌     | 9/20 [00:17<00:20,  1.84s/it, loss=5.9] init_train_0:  50%|█████     | 10/20 [00:18<00:18,  1.84s/it, loss=5.9]init_train_0:  50%|█████     | 10/20 [00:19<00:18,  1.84s/it, loss=5.89]init_train_0:  55%|█████▌    | 11/20 [00:20<00:16,  1.84s/it, loss=5.89]init_train_0:  55%|█████▌    | 11/20 [00:20<00:16,  1.84s/it, loss=5.88]init_train_0:  60%|██████    | 12/20 [00:22<00:14,  1.84s/it, loss=5.88]init_train_0:  60%|██████    | 12/20 [00:22<00:14,  1.84s/it, loss=5.88]init_train_0:  65%|██████▌   | 13/20 [00:23<00:12,  1.85s/it, loss=5.88]init_train_0:  65%|██████▌   | 13/20 [00:24<00:12,  1.85s/it, loss=5.88]init_train_0:  70%|███████   | 14/20 [00:25<00:11,  1.85s/it, loss=5.88]init_train_0:  70%|███████   | 14/20 [00:26<00:11,  1.85s/it, loss=5.88]init_train_0:  75%|███████▌  | 15/20 [00:27<00:09,  1.85s/it, loss=5.88]init_train_0:  75%|███████▌  | 15/20 [00:28<00:09,  1.85s/it, loss=5.87]init_train_0:  80%|████████  | 16/20 [00:29<00:07,  1.85s/it, loss=5.87]init_train_0:  80%|████████  | 16/20 [00:30<00:07,  1.85s/it, loss=5.87]init_train_0:  85%|████████▌ | 17/20 [00:31<00:05,  1.85s/it, loss=5.87]init_train_0:  85%|████████▌ | 17/20 [00:32<00:05,  1.85s/it, loss=5.87]init_train_0:  90%|█████████ | 18/20 [00:33<00:03,  1.85s/it, loss=5.87]init_train_0:  90%|█████████ | 18/20 [00:33<00:03,  1.85s/it, loss=5.86]init_train_0:  95%|█████████▌| 19/20 [00:35<00:01,  1.85s/it, loss=5.86]init_train_0:  95%|█████████▌| 19/20 [00:35<00:01,  1.85s/it, loss=5.86]init_train_0: 100%|██████████| 20/20 [00:36<00:00,  1.69s/it, loss=5.86]init_train_0: 100%|██████████| 20/20 [00:36<00:00,  1.82s/it, loss=5.86]
init_train_0 loss is 5.856049942970276
WARNING clustering 320 points to 20 centroids: please provide at least 780 training points
WARNING clustering 198 points to 20 centroids: please provide at least 780 training points
WARNING clustering 103 points to 20 centroids: please provide at least 780 training points
WARNING clustering 320 points to 20 centroids: please provide at least 780 training points
WARNING clustering 136 points to 20 centroids: please provide at least 780 training points
WARNING clustering 20 points to 10 centroids: please provide at least 390 training points
WARNING clustering 320 points to 20 centroids: please provide at least 780 training points
WARNING clustering 112 points to 20 centroids: please provide at least 780 training points
WARNING clustering 199 points to 20 centroids: please provide at least 780 training points
WARNING clustering 92 points to 20 centroids: please provide at least 780 training points
WARNING clustering 320 points to 20 centroids: please provide at least 780 training points
WARNING clustering 179 points to 20 centroids: please provide at least 780 training points
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:00<00:00,  1.56it/s]100%|██████████| 2/2 [00:00<00:00,  2.48it/s]100%|██████████| 2/2 [00:00<00:00,  2.27it/s]
Use adam optim!
memory_train_0:   0%|          | 0/2 [00:00<?, ?it/s]memory_train_0:  50%|█████     | 1/2 [00:01<00:01,  1.89s/it]memory_train_0: 100%|██████████| 2/2 [00:02<00:00,  1.21s/it]memory_train_0: 100%|██████████| 2/2 [00:02<00:00,  1.31s/it]
memory_train_0 loss is 3.645581603050232
Restart Num 1
task--3:
current test acc:0.678082191780822
history test acc:0.6134663341645885
[0.918918918918919, 0.9532710280373832, 0.678082191780822]
[0.918918918918919, 0.4196078431372549, 0.6134663341645885]
['per:stateorprovinces_of_residence', 'org:alternate_names', 'org:country_of_headquarters', 'per:country_of_birth']
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:15,  1.57it/s]  8%|▊         | 2/25 [00:01<00:15,  1.52it/s] 12%|█▏        | 3/25 [00:01<00:14,  1.51it/s] 16%|█▌        | 4/25 [00:02<00:13,  1.52it/s] 20%|██        | 5/25 [00:03<00:13,  1.51it/s] 24%|██▍       | 6/25 [00:03<00:12,  1.51it/s] 28%|██▊       | 7/25 [00:04<00:11,  1.52it/s] 32%|███▏      | 8/25 [00:05<00:11,  1.51it/s] 36%|███▌      | 9/25 [00:05<00:10,  1.52it/s] 40%|████      | 10/25 [00:06<00:09,  1.52it/s] 44%|████▍     | 11/25 [00:07<00:09,  1.51it/s] 48%|████▊     | 12/25 [00:07<00:08,  1.51it/s] 52%|█████▏    | 13/25 [00:08<00:07,  1.51it/s] 56%|█████▌    | 14/25 [00:09<00:07,  1.51it/s] 60%|██████    | 15/25 [00:09<00:06,  1.51it/s] 64%|██████▍   | 16/25 [00:10<00:05,  1.51it/s] 68%|██████▊   | 17/25 [00:11<00:05,  1.51it/s] 72%|███████▏  | 18/25 [00:11<00:04,  1.51it/s] 76%|███████▌  | 19/25 [00:12<00:03,  1.51it/s] 80%|████████  | 20/25 [00:13<00:03,  1.51it/s] 84%|████████▍ | 21/25 [00:13<00:02,  1.51it/s] 88%|████████▊ | 22/25 [00:14<00:01,  1.51it/s] 92%|█████████▏| 23/25 [00:15<00:01,  1.51it/s] 96%|█████████▌| 24/25 [00:15<00:00,  1.51it/s]100%|██████████| 25/25 [00:16<00:00,  1.70it/s]100%|██████████| 25/25 [00:16<00:00,  1.54it/s]
Use adam optim!
init_train_0:   0%|          | 0/25 [00:00<?, ?it/s]init_train_0:   0%|          | 0/25 [00:00<?, ?it/s, loss=5.81]init_train_0:   4%|▍         | 1/25 [00:01<00:45,  1.90s/it, loss=5.81]init_train_0:   4%|▍         | 1/25 [00:02<00:45,  1.90s/it, loss=5.78]init_train_0:   8%|▊         | 2/25 [00:03<00:43,  1.90s/it, loss=5.78]init_train_0:   8%|▊         | 2/25 [00:04<00:43,  1.90s/it, loss=5.77]init_train_0:  12%|█▏        | 3/25 [00:05<00:41,  1.89s/it, loss=5.77]init_train_0:  12%|█▏        | 3/25 [00:06<00:41,  1.89s/it, loss=5.76]init_train_0:  16%|█▌        | 4/25 [00:07<00:39,  1.89s/it, loss=5.76]init_train_0:  16%|█▌        | 4/25 [00:08<00:39,  1.89s/it, loss=5.75]init_train_0:  20%|██        | 5/25 [00:09<00:37,  1.88s/it, loss=5.75]init_train_0:  20%|██        | 5/25 [00:10<00:37,  1.88s/it, loss=5.75]init_train_0:  24%|██▍       | 6/25 [00:11<00:35,  1.87s/it, loss=5.75]init_train_0:  24%|██▍       | 6/25 [00:11<00:35,  1.87s/it, loss=5.75]init_train_0:  28%|██▊       | 7/25 [00:13<00:33,  1.87s/it, loss=5.75]init_train_0:  28%|██▊       | 7/25 [00:13<00:33,  1.87s/it, loss=5.75]init_train_0:  32%|███▏      | 8/25 [00:14<00:31,  1.86s/it, loss=5.75]init_train_0:  32%|███▏      | 8/25 [00:15<00:31,  1.86s/it, loss=5.74]init_train_0:  36%|███▌      | 9/25 [00:16<00:29,  1.86s/it, loss=5.74]init_train_0:  36%|███▌      | 9/25 [00:17<00:29,  1.86s/it, loss=5.74]init_train_0:  40%|████      | 10/25 [00:18<00:27,  1.86s/it, loss=5.74]init_train_0:  40%|████      | 10/25 [00:19<00:27,  1.86s/it, loss=5.74]init_train_0:  44%|████▍     | 11/25 [00:20<00:26,  1.86s/it, loss=5.74]init_train_0:  44%|████▍     | 11/25 [00:21<00:26,  1.86s/it, loss=5.74]init_train_0:  48%|████▊     | 12/25 [00:22<00:24,  1.86s/it, loss=5.74]init_train_0:  48%|████▊     | 12/25 [00:23<00:24,  1.86s/it, loss=5.73]init_train_0:  52%|█████▏    | 13/25 [00:24<00:22,  1.86s/it, loss=5.73]init_train_0:  52%|█████▏    | 13/25 [00:24<00:22,  1.86s/it, loss=5.73]init_train_0:  56%|█████▌    | 14/25 [00:26<00:20,  1.86s/it, loss=5.73]init_train_0:  56%|█████▌    | 14/25 [00:26<00:20,  1.86s/it, loss=5.73]init_train_0:  60%|██████    | 15/25 [00:28<00:18,  1.86s/it, loss=5.73]init_train_0:  60%|██████    | 15/25 [00:28<00:18,  1.86s/it, loss=5.73]init_train_0:  64%|██████▍   | 16/25 [00:29<00:16,  1.86s/it, loss=5.73]init_train_0:  64%|██████▍   | 16/25 [00:30<00:16,  1.86s/it, loss=5.72]init_train_0:  68%|██████▊   | 17/25 [00:31<00:14,  1.86s/it, loss=5.72]init_train_0:  68%|██████▊   | 17/25 [00:32<00:14,  1.86s/it, loss=5.73]init_train_0:  72%|███████▏  | 18/25 [00:33<00:13,  1.86s/it, loss=5.73]init_train_0:  72%|███████▏  | 18/25 [00:34<00:13,  1.90s/it, loss=5.73]
Traceback (most recent call last):
  File "run_continual.py", line 22, in <module>
    run(args)
  File "run_continual.py", line 11, in run
    manager.train(args)
  File "/home/v-chengweihu/code/CRL-change/methods/manager.py", line 346, in train
    self.train_simple_model(args, encoder, train_data_for_initial, args.step1_epochs)
  File "/home/v-chengweihu/code/CRL-change/methods/manager.py", line 188, in train_simple_model
    train_data(data_loader, "init_train_{}".format(epoch_i), is_mem=False)
  File "/home/v-chengweihu/code/CRL-change/methods/manager.py", line 174, in train_data
    hidden, reps = encoder.bert_forward(tokens)
  File "/home/v-chengweihu/code/CRL-change/methods/model.py", line 19, in bert_forward
    out = self.encoder(x)
  File "/anaconda/envs/exp/lib/python3.8/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/v-chengweihu/code/CRL-change/methods/backbone.py", line 60, in forward
    instance_output = torch.index_select(tokens_output, 0, torch.tensor(i).cuda())
KeyboardInterrupt
